%%% REMEMBER TO COMPILE WITH LuaLaTeX! %%%

%%% From https://tex.stackexchange.com/questions/94582/automating-the-creation-of-name-badges-for-an-event

%%% use the corresponding paper size for your ticket definition
\documentclass[a4paper,10pt,landscape]{letter}
% \usepackage[top=0cm,left=0cm]{geometry}
% \setlength{\topskip}{0pt}

\usepackage{graphicx}
% \usepackage{mfirstuc} % word capitalisation
\usepackage{tikz}
\usepackage[inkscapelatex=false]{svg}

%%% choose ticket.sty from ticket package's template for conference pins
\usepackage[freepin,crossmark]{ticket}
\unitlength=1mm
\ticketSize{90}{170}
\ticketDistance{0}{0}
\ticketNumbers{3}{1}

%%% Select font
\usepackage{fontspec}
\setmainfont{Andale Mono}

% ---------------------- % 

%%% make your default ticket. \ticketdefault is somewhat like a background
\renewcommand{\ticketdefault}{
  % \put(1,95){\includegraphics[width=88mm]{../graphics/cybo_2025/BC_1_noqr.svg}}
  % \put(1,75){\includegraphics[width=88mm,angle=180]{../graphics/cybo_2025/BC_1_noqr.svg}}
  % \put(1,75){\includesvg[width=88mm]{../graphics/cybo_2025/BC_1_noqr.svg}}
  % \put(1,5){\includesvg[width=88mm,angle=180]{../graphics/cybo_2025/BC_1_noqr.svg}}
}

%%% define function that prints the two fields - v3
\newcommand{\confpin}[3]{\ticket{
    % ---------------------- % 
    %%% Background image
    \put(1,85){\includesvg[width=88mm]{../graphics/cybo_2025/#3}}
    \put(1,85){\rotatebox{180}{\includesvg[width=88mm]{../graphics/cybo_2025/#3}}}
    % ---------------------- % 
    %%% Vanilla parbox, w/ hack...
    \put(24.75,144.75){\parbox{.50\linewidth}{\bfseries\Huge\raggedleft \textcolor{white}{#1}}} % name
    \put(25,145){\parbox{.50\linewidth}{\bfseries\Huge\raggedleft #1}} % name
    \put(29.825,124.825){\parbox{.45\linewidth}{\bfseries\large\raggedleft \textcolor{white}{#2}}} % affiliation
    \put(30,125){\parbox{.45\linewidth}{\bfseries\large\raggedleft #2}} % affiliation
    % ---------------------- % 
    % Dotted lines, etc.
    \put(42.5,5){\tikz[fill=none,draw=gray] \draw [dash dot] (0,0) circle (2.5mm) node [xshift=0mm] {};} % bottom circle
    % \put(0,15){\tikz[baseline=-0.5ex,draw=gray] \draw [dash dot] (1mm,0) -- (89mm,0);} % top line
    \put(0,85){\tikz[baseline=-0.5ex,draw=gray] \draw [dash dot] (1mm,0) -- (89mm,0);} % middle line
    % \put(0,155){\tikz[baseline=-0.5ex,draw=gray] \draw [dash dot] (1mm,0) -- (89mm,0);} % bottom line
    \put(42.5,160){\tikz[fill=none,draw=gray] \draw [dash dot] (0,0) circle (2.5mm) node [xshift=0mm] {};} % top circle
    % ---------------------- % 
    %%% Vanilla parbox, flipped, w/ hack...
    \put(5.125,45.125){\rotatebox{180}{\parbox{.45\linewidth}{\bfseries\large\raggedleft \textcolor{white}{#2}}}} % affiliation, specular
    \put(5,45){\rotatebox{180}{\parbox{.45\linewidth}{\bfseries\large\raggedleft #2}}} % affiliation, specular
    \put(5.25,25.25){\rotatebox{180}{\parbox{.50\linewidth}{\bfseries\Huge\raggedleft \textcolor{white}{#1}}}} % name, specular
    \put(5,25){\rotatebox{180}{\parbox{.50\linewidth}{\bfseries\Huge\raggedleft #1}}} % name, specular
    }}

%%% grab the \confpin bit from here: 
%%% https://docs.google.com/spreadsheets/d/1rASq-GHYglUGBy9cxT3poznBz1c4UOBVyVqRLF1JGeI/edit#gid=610836843

% ---------------------- % 

%%% 
\begin{document}

% \pagenumbering{roman}

% \sffamily

\confpin{Thomas Abeli}{University of Pavia (IT)}{BC_3_noqr.svg}
\confpin{Elisa Beninato}{University of Parma  (IT)}{BC_2_noqr.svg}
\confpin{Gianmaria Bonari}{University of Siena (IT)}{BC_1_noqr.svg}
\confpin{Francesco Candini}{University of Siena (IT)}{BC_3_noqr.svg}
\confpin{Elena Capuzzi}{University of Genova (IT)}{BC_3_noqr.svg}
\confpin{Gabriele Casazza}{University of Genova (IT)}{BC_2_noqr.svg}
\confpin{Clara Conte}{University of Genova (IT)}{BC_2_noqr.svg}
\confpin{Benedetta D'Ambrosio}{University of Pisa (IT)}{BC_3_noqr.svg}
\confpin{Giulia Dal Maso}{University of Torino (IT)}{BC_2_noqr.svg}
\confpin{Simone Di Piazza}{University of Genova (IT)}{BC_2_noqr.svg}
\confpin{Beatrice Fois}{University of Milano (IT)}{BC_1_noqr.svg}
\confpin{T'Ai Forte}{University of Parma (IT)}{BC_3_noqr.svg}
\confpin{Tommaso Gabbriellini}{University of Firenze (IT)}{BC_3_noqr.svg}
\confpin{Daniele Giugia}{University of Genova (IT)}{BC_2_noqr.svg}
\confpin{Arianna Gualdi}{University of Pisa (IT)}{BC_2_noqr.svg}
\confpin{Maria Guerrina}{University of Genova (IT)}{BC_2_noqr.svg}
\confpin{Francesco Laspina}{University of Catania (IT)}{BC_1_noqr.svg}
\confpin{Silvano Lodetti}{University of Pavia (IT)}{BC_1_noqr.svg}
\confpin{Paola Malaspina}{University of Genova (IT)}{BC_3_noqr.svg}
\confpin{Veronica Maresca}{University of Pavia (IT)}{BC_3_noqr.svg}
\confpin{Camilla Micaletti}{University of Genova (IT)}{BC_2_noqr.svg}
\confpin{Micol Orengo}{University of Pavia (IT)}{BC_1_noqr.svg}
\confpin{Serena Pannuzzo}{University of Catania (IT)}{BC_2_noqr.svg}
\confpin{Luca Pegoraro}{Federal Research Institute WSL (CH)}{BC_3_noqr.svg}
\confpin{Laurie Proes}{University of Innsbruck (AT)}{BC_3_noqr.svg}
\confpin{Paola Raffo}{University of Pisa (IT)}{BC_3_noqr.svg}
\confpin{Marilena Ronzan}{Istituto Italiano di Tecnologia (IT)}{BC_2_noqr.svg}
\confpin{Adriana Santanello}{University of Catania (IT)}{BC_3_noqr.svg}
\confpin{Antonella Smeriglio}{University of Messina (IT)}{BC_2_noqr.svg}
\confpin{Letizia Tomati}{nan (IT)}{BC_1_noqr.svg}
\confpin{Damiano Trovato}{University of Catania (IT)}{BC_3_noqr.svg}
\confpin{Elena Tuccio}{University of Torino (IT)}{BC_3_noqr.svg}
\confpin{Chiara Vallese}{University of Genova (IT)}{BC_3_noqr.svg}
\confpin{Lucia Varaldo}{University of Genova (IT)}{BC_2_noqr.svg}
\confpin{David Wulsdorf}{Technical University Braunschweig (DE)}{BC_2_noqr.svg}
\confpin{Enrica Roccotiello}{University of Genova (IT)}{BC_2_noqr.svg}
\confpin{Chiara Montagnani}{University of Milano Bicocca (IT)}{BC_2_noqr.svg}
\confpin{Lilla Gyüre}{Széchenyi Egyetem - University of Győr (HU)}{BC_3_noqr.svg}
\confpin{Balázs Huszár}{Széchenyi Egyetem - University of Győr (HU)}{BC_2_noqr.svg}
\confpin{Erik Pózer}{Independent Researcher (HU)}{BC_2_noqr.svg}
\confpin{Botond Gaál}{Hungarian University of Agriculture and Life Sciences (HU)}{BC_2_noqr.svg}
\confpin{Gergely Vajda}{Hungarian University of Agriculture and Life Sciences (HU)}{BC_1_noqr.svg}
\confpin{Hanna Révész}{University of Debrecen (HU)}{BC_1_noqr.svg}
\confpin{Cristina Blandino}{University of Catania (IT)}{BC_1_noqr.svg}
\confpin{Letizia Tomati}{ }{BC_2_noqr.svg}
\confpin{Elena Venere}{ }{BC_3_noqr.svg}
\confpin{Lilla Gyüre}{Hungarian University of Agriculture and Life Sciences (HU)}{BC_3_noqr.svg}
\confpin{Gergely Vajda}{Hungarian University of Agriculture and Life Sciences (HU)}{BC_1_noqr.svg}
\confpin{Hanna Révész}{University of Debrecen (HU)}{BC_1_noqr.svg}
\confpin{Nubia Guzmán}{University of Milano Bicocca (IT), University of Azuay (EC)}{BC_1_noqr.svg}{Guzmán_Nubia.svg}
\confpin{Margherita Tognela}{University of Pavia (IT)}{BC_1_noqr.svg}{Tognela_Margherita.svg}

\end{document}